%define name       @PACKAGE@
%define version	   @VERSION@
%define release    1
%define serial     1
%define prefix     /usr

Summary:           A WorldForge client library.
Name:              %{name} 
Version:           %{version} 
Release:           %{release}
Serial:            %{serial}
Copyright:         GPL
Group:             System Environment/Libraries
Source:            %{name}-%{version}.tar.gz
BuildRoot:         /var/tmp/%{name}-%{version}-buildroot
Requires:          Atlas-C++ >= 0.4.4 wfmath >= 0.2.10 skstream > 0.2 libstdc++
BuildRequires:     Atlas-C++-devel >= 0.4.4 wfmath-devel >= 0.2.10 skstream-devel > 0.2 libstdc++-devel >= 2.95.2

%description
Eris is designed to simplify client development (and avoid repeating the same
work several times), by providing a common system to deal with the back end
tasks.

%package devel
Summary:           A WorldForge client library headers and static libs.
Group:             Development/Libraries
Requires:          %{name} = %{version}

%description devel
Eris is designed to simplify client development (and avoid repeating the same
work several times), by providing a common system to deal with the back end
tasks.

%package poll-glib
Summary:           Headers to poll eris connections using glibs poll code.
Group:             Development/Libraries
Requires:          glib2

%description poll-glib
Eris is designed to simplify client development (and avoid repeating the same
work several times), by providing a common system to deal with the back end
tasks. These headers allow code handling network connections for Eris
to be integrated into glib in a glib or gtk+ based application.

%prep
%setup

%build
CXXFLAGS=$RPM_OPT_FLAGS ./configure --prefix=%{prefix} --enable-static=yes
make

%install
rm -rf $RPM_BUILD_ROOT
make prefix=$RPM_BUILD_ROOT%{prefix} install

%clean
rm -rf $RPM_BUILD_ROOT

%files
%defattr(-,root,root)
%{prefix}/lib/liberis-1.0.so.*
%doc AUTHORS COPYING NEWS README

%files devel
%defattr(-,root,root)
%{prefix}/bin/eris-config
%{prefix}/include/Eris-1.0/Eris/ArgumentDispatcher.h
%{prefix}/include/Eris-1.0/Eris/atlas_utils.h
%{prefix}/include/Eris-1.0/Eris/Avatar.h
%{prefix}/include/Eris-1.0/Eris/BaseConnection.h
%{prefix}/include/Eris-1.0/Eris/ClassDispatcher.h
%{prefix}/include/Eris-1.0/Eris/Connection.h
%{prefix}/include/Eris-1.0/Eris/DebugDispatcher.h
%{prefix}/include/Eris-1.0/Eris/Dispatcher.h
%{prefix}/include/Eris-1.0/Eris/EncapDispatcher.h
%{prefix}/include/Eris-1.0/Eris/Entity.h
%{prefix}/include/Eris-1.0/Eris/Factory.h
%{prefix}/include/Eris-1.0/Eris/IdDispatcher.h
%{prefix}/include/Eris-1.0/Eris/Lobby.h
%{prefix}/include/Eris-1.0/Eris/Log.h
%{prefix}/include/Eris-1.0/Eris/Metaserver.h
%{prefix}/include/Eris-1.0/Eris/OpDispatcher.h
%{prefix}/include/Eris-1.0/Eris/Person.h
%{prefix}/include/Eris-1.0/Eris/Player.h
%{prefix}/include/Eris-1.0/Eris/PollDefault.h
%{prefix}/include/Eris-1.0/Eris/Poll.h
%{prefix}/include/Eris-1.0/Eris/Property.h
%{prefix}/include/Eris-1.0/Eris/Room.h
%{prefix}/include/Eris-1.0/Eris/ServerInfo.h
%{prefix}/include/Eris-1.0/Eris/SignalDispatcher.h
%{prefix}/include/Eris-1.0/Eris/Timeout.h
%{prefix}/include/Eris-1.0/Eris/Timestamp.h
%{prefix}/include/Eris-1.0/Eris/TypeDispatcher.h
%{prefix}/include/Eris-1.0/Eris/TypeInfo.h
%{prefix}/include/Eris-1.0/Eris/Types.h
%{prefix}/include/Eris-1.0/Eris/Utils.h
%{prefix}/include/Eris-1.0/Eris/Wait.h
%{prefix}/include/Eris-1.0/Eris/World.h
%{prefix}/lib/liberis-1.0.a
%{prefix}/lib/liberis-1.0.la
%{prefix}/lib/liberis-1.0.so
%{prefix}/lib/pkgconfig/eris-1.0.pc
%{prefix}/share/aclocal/eris.m4

%files poll-glib
%defattr(-,root,root)
%{prefix}/lib/pkgconfig/eris-poll-glib-1.0.pc
%{prefix}/include/Eris-1.0/Eris/PollGlibFD.h
%{prefix}/include/Eris-1.0/Eris/PollGlib.h
%{prefix}/include/Eris-1.0/Eris/PollGlibSource.h
%{prefix}/include/Eris-1.0/Eris/PollGlibVersion.h
